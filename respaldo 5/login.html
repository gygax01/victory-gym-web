<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login - Victory Pro Fitness</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body class="centered login-bg">

<div class="card login-card">
  <div class="login-logo">
    <img src="img/logo.png" alt="Victory Pro Fitness">
  </div>

  <input id="inputUser" placeholder="Usuario">
  <input id="inputPass" type="password" placeholder="Contraseña">

  <button class="btn-login" id="btnLogin">Ingresar</button>

  <hr>

  <button class="nfc btn-nfc" id="btnNFC">Ingresar con tarjeta</button>

  <button class="btn-sec" onclick="location.href='usuarios.html?modo=registro'">
    Registrar usuario
  </button>

  <p class="small muted">Acceso exclusivo para personal autorizado</p>
</div>

<!-- NFC -->
<div class="overlay" id="overlay" style="display:none">
  <div class="popup">
    <h2>Acerque la tarjeta</h2>
    <div id="estadoNFC" class="estado amarillo">Esperando tarjeta…</div>
  </div>
</div>

<!-- USUARIO -->
<div class="overlay" id="overlayUsuario" style="display:none">
  <div class="popup">
    <h2>Usuario no encontrado</h2>
    <div class="estado rojo">El usuario ingresado no existe</div>
  </div>
</div>

<!-- PASSWORD -->
<div class="overlay" id="overlayPassword" style="display:none">
  <div class="popup">
    <h2>Error de acceso</h2>
    <div class="estado rojo">La contraseña es incorrecta</div>
  </div>
</div>

<script src="js/storage.js"></script>
<script src="js/auth.js"></script>
<script src="js/nfc.js"></script>

<script>
const inputUser = document.getElementById("inputUser");
const inputPass = document.getElementById("inputPass");
const btnLogin = document.getElementById("btnLogin");

const overlayUsuario = document.getElementById("overlayUsuario");
const overlayPassword = document.getElementById("overlayPassword");

btnLogin.onclick = () => {
  const r = login(inputUser.value.trim(), inputPass.value, 200);

  if (r === "NO_USER") {
    overlayUsuario.style.display = "flex";
    setTimeout(() => overlayUsuario.style.display = "none", 1500);
  }

  if (r === "BAD_PASS") {
    overlayPassword.style.display = "flex";
    setTimeout(() => overlayPassword.style.display = "none", 1500);
  }
};
</script>

</body>
</html>
